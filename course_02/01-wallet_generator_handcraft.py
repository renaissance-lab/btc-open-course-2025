r'''
æ¯”ç‰¹å¸é’±åŒ…ç”Ÿæˆå™¨ - è‡ªå·±æ‰‹æ“æ‹¼æ¥

æœ¬ç¨‹åºç”¨äºåˆ›å»ºæ¯”ç‰¹å¸æµ‹è¯•ç½‘é’±åŒ…ï¼Œç”Ÿæˆç§é’¥ã€å…¬é’¥ã€åœ°å€å’ŒWIFæ ¼å¼,é€šè¿‡æœ¬ä¾‹ä»‹ç»ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚

è¾“å‡ºç¤ºä¾‹:
===== æ¯”ç‰¹å¸æµ‹è¯•ç½‘é’±åŒ… =====
åœ°å€: mtcUJ4H94D4VhWE3n8VSVEFG4V2K1qVRja
ç§é’¥(HEX): 2d4cc82c6ab7b2feb8e7268a69373492e4087cd8783d43d93064a7c6658bfbea
ç§é’¥(WIF): cP6kxoT6rau6x1Ljku55Vb2xFA9ox5ZC8Eg1kexdpaSzKM8A673z
å…¬é’¥(å‹ç¼©),å­—èŠ‚: b'\x03\xbc\xa5\x95\xc2\xad\xc2`d\xe5\x1aUK\xc5\x0b\x01\x87%\xeb\x9a\x8c`\xc6/\x93\x7f\xae\xc0\xae\xf2\x96\x98\n'
å…¬é’¥(å‹ç¼©): 03bca595c2adc26064e51a554bc50b018725eb9a8c60c62f937faec0aef296980a
å…¬é’¥(æœªå‹ç¼©): 04bca595c2adc26064e51a554bc50b018725eb9a8c60c62f937faec0aef296980a9d5436348fb62abf83bc5344e963595ecef26f7f927178bed7ffa37f39339311

ä»¥ä¸‹ä¸ºè¯¦ç»†æ¦‚å¿µè§£é‡Šï¼š

0. åœ°å€: mtcUJ4H94D4VhWE3n8VSVEFG4V2K1qVRja
   - è¿™æ˜¯ä¸€ä¸ªP2PKH(Pay to Public Key Hash)ç±»å‹çš„æ¯”ç‰¹å¸æµ‹è¯•ç½‘åœ°å€
   - åœ°å€ä»¥"m"å¼€å¤´ï¼Œè¡¨æ˜è¿™æ˜¯æµ‹è¯•ç½‘åœ°å€(ç”±å‰ç¼€0x6Fç¡®å®š)
   - 34ä¸ªå­—ç¬¦é•¿åº¦ï¼ŒåŒ…å«äº†Base58ç¼–ç åçš„[å‰ç¼€+å…¬é’¥å“ˆå¸Œ+æ ¡éªŒå’Œ]

1. ç§é’¥(HEX): 3f94562ff2c85f1f2e4193f1bc9d85a157d90a84849c51ff64f45e029c704b28
   - è¿™æ˜¯ä¸€ä¸ªéšæœºç”Ÿæˆçš„32å­—èŠ‚(256ä½)çš„æ•°å­—ï¼Œç”¨åå…­è¿›åˆ¶è¡¨ç¤ºä¸º64ä¸ªå­—ç¬¦
   - ç§é’¥æ˜¯é’±åŒ…çš„æ ¸å¿ƒï¼Œæ§åˆ¶ç€é’±åŒ…ä¸­æ‰€æœ‰èµ„äº§çš„æ‰€æœ‰æƒ
   - åœ¨ä»£ç ä¸­é€šè¿‡random.randint(0, 255)ç”Ÿæˆ32ä¸ªéšæœºå­—èŠ‚

2. ç§é’¥(WIF): 924vDQQ5xunCSbhe29DtDjQY3BYZnqFdfT1R4hyawnLzXkUu9a8
   - WIF(Wallet Import Format)æ˜¯ç§é’¥çš„ç”¨æˆ·å‹å¥½è¡¨ç¤ºå½¢å¼
   - ç”Ÿæˆè¿‡ç¨‹:
     a. æ·»åŠ å‰ç¼€å­—èŠ‚0xEF(åè¿›åˆ¶239)ï¼Œè¡¨ç¤ºè¿™æ˜¯æµ‹è¯•ç½‘ç§é’¥
     b. è®¡ç®—åŒé‡SHA256å“ˆå¸Œï¼Œå–å‰4å­—èŠ‚ä½œä¸ºæ ¡éªŒå’Œ
     c. å°†[å‰ç¼€+ç§é’¥+æ ¡éªŒå’Œ]é€šè¿‡Base58ç¼–ç å¾—åˆ°WIFå­—ç¬¦ä¸²
   - æ€»å…±37å­—èŠ‚(1å‰ç¼€+32ç§é’¥+4æ ¡éªŒå’Œ)ï¼Œç»Base58ç¼–ç å˜ä¸º51-52ä¸ªå­—ç¬¦
   - ä½¿ç”¨WIFå¯ä»¥åœ¨å¤§å¤šæ•°é’±åŒ…è½¯ä»¶ä¸­è½»æ¾å¯¼å…¥ç§é’¥

3. å…¬é’¥(æœªå‹ç¼©): 04ae8ad65d446813d3745934ddab5f176c64d671a3e2db91e3b17f7e8644f21a936c04b7db839f8caad551be4dddd0b12cc42bb4bcbcbd2663f2efab6237519c59
   - é€šè¿‡SECP256k1æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ä»ç§é’¥æ´¾ç”Ÿå‡ºçš„å…¬é’¥
   - ç›¸æ¯”å‹ç¼©æ ¼å¼ï¼Œå¤šå­˜å‚¨äº†Yåæ ‡ä¿¡æ¯
   - æœªå‹ç¼©æ ¼å¼: 65å­—èŠ‚(130ä¸ªåå…­è¿›åˆ¶å­—ç¬¦)
     a. 1å­—èŠ‚å‰ç¼€0x04ï¼Œè¡¨ç¤ºæœªå‹ç¼©å…¬é’¥
     b. 32å­—èŠ‚Xåæ ‡: ae8ad65d446813d3745934ddab5f176c64d671a3e2db91e3b17f7e8644f21a93
     c. 32å­—èŠ‚Yåæ ‡: 6c04b7db839f8caad551be4dddd0b12cc42bb4bcbcbd2663f2efab6237519c59

4. å…¬é’¥(å‹ç¼©): 03ae8ad65d446813d3745934ddab5f176c64d671a3e2db91e3b17f7e8644f21a93
   - å‹ç¼©æ ¼å¼: 33å­—èŠ‚(66ä¸ªåå…­è¿›åˆ¶å­—ç¬¦)
     a. 1å­—èŠ‚å‰ç¼€(0x02æˆ–0x03)ï¼Œè¡¨ç¤ºYåæ ‡çš„å¥‡å¶æ€§
       - 0x02: Yåæ ‡ä¸ºå¶æ•°
       - 0x03: Yåæ ‡ä¸ºå¥‡æ•°(æœ¬ä¾‹ä¸­ä½¿ç”¨0x03ï¼Œè¡¨ç¤ºYåæ ‡ä¸ºå¥‡æ•°)
     b. 32å­—èŠ‚Xåæ ‡
   - å‹ç¼©å…¬é’¥å¯ä»¥èŠ‚çœç©ºé—´ï¼Œç‰¹åˆ«æ˜¯åœ¨åŒºå—é“¾ä¸Šå­˜å‚¨äº¤æ˜“æ—¶
   - è¿™æ˜¯æ¨èåœ¨åŒºå—é“¾ä¸Šä½¿ç”¨çš„æ ¼å¼ï¼ŒèŠ‚çœç©ºé—´å’Œæ‰‹ç»­è´¹

5. å…¬é’¥(å‹ç¼©),å­—èŠ‚: b'\x03\xbc\xa5\x95\xc2\xad\xc2`d\xe5\x1aUK\xc5\x0b\x01\x87%\xeb\x9a\x8c`\xc6/\x93\x7f\xae\xc0\xae\xf2\x96\x98\n'
   - è¿™æ˜¯Pythonçš„byteså¯¹è±¡è¡¨ç¤ºæ³•ï¼Œæ˜¾ç¤ºäº†33å­—èŠ‚çš„å‹ç¼©å…¬é’¥
   - \xNNæ ¼å¼è¡¨ç¤ºä¸å¯æ‰“å°æˆ–ç‰¹æ®Šçš„å­—èŠ‚(åå…­è¿›åˆ¶è¡¨ç¤º)
   - å¯æ‰“å°ASCIIå­—ç¬¦ç›´æ¥æ˜¾ç¤ºä¸ºå­—ç¬¦æœ¬èº«
   - \x03å‰ç¼€è¡¨ç¤ºYåæ ‡ä¸ºå¥‡æ•°

6. åœ°å€: mhEMAY2yKRCWfM3ppcRrJe2pkZSzuVGQ7k
   - è¿™æ˜¯ä¸€ä¸ªP2PKH(Pay to Public Key Hash)ç±»å‹çš„æ¯”ç‰¹å¸æµ‹è¯•ç½‘åœ°å€
   - ç”Ÿæˆè¿‡ç¨‹:
     a. å¯¹å…¬é’¥è¿›è¡ŒSHA-256å“ˆå¸Œ
     b. å¯¹ç»“æœè¿›è¡ŒRIPEMD-160å“ˆå¸Œï¼Œå¾—åˆ°20å­—èŠ‚çš„å…¬é’¥å“ˆå¸Œ(PUBKEY HASH)
     c. æ·»åŠ æµ‹è¯•ç½‘å‰ç¼€0x6F
     d. è®¡ç®—åŒé‡SHA-256æ ¡éªŒå’Œï¼Œå–å‰4å­—èŠ‚
     e. å°†[å‰ç¼€+å…¬é’¥å“ˆå¸Œ+æ ¡éªŒå’Œ]é€šè¿‡Base58ç¼–ç 
   - æ€»å…±25å­—èŠ‚(1å‰ç¼€+20å…¬é’¥å“ˆå¸Œ+4æ ¡éªŒå’Œ)ï¼ŒBase58ç¼–ç åå¾—åˆ°çº¦34ä¸ªå­—ç¬¦
   - åœ°å€ä»¥"m"å¼€å¤´ï¼Œè¿™æ˜¯å› ä¸ºæµ‹è¯•ç½‘å‰ç¼€0x6Fåœ¨Base58ç¼–ç åé€šå¸¸ä¼šç”Ÿæˆ"m"æˆ–"n"å¼€å¤´çš„å­—ç¬¦ä¸²
   - ä¸ä¹‹å¯¹åº”ï¼Œä¸»ç½‘å‰ç¼€0x00ä¼šç”Ÿæˆ"1"å¼€å¤´çš„åœ°å€

å®‰å…¨æ³¨æ„äº‹é¡¹:
1. ç§é’¥æ˜¯å”¯ä¸€å¯ä»¥æ§åˆ¶æ¯”ç‰¹å¸çš„å¯†é’¥ï¼Œå¿…é¡»å®‰å…¨ä¿å­˜
2. ä»»ä½•è·å¾—ç§é’¥çš„äººéƒ½å¯ä»¥æ§åˆ¶ç›¸åº”åœ°å€ä¸­çš„æ‰€æœ‰èµ„é‡‘
3. æµ‹è¯•ç½‘åœ°å€åªèƒ½ç”¨äºæµ‹è¯•ç½‘ç»œï¼Œä¸èƒ½ç”¨äºçœŸå®æ¯”ç‰¹å¸äº¤æ˜“
4. å“ˆå¸Œå‡½æ•°å’Œæ¤­åœ†æ›²çº¿åŠ å¯†ä¿è¯äº†ä»å…¬é’¥æ— æ³•åæ¨ç§é’¥ï¼Œä»åœ°å€æ— æ³•åæ¨å…¬é’¥

æ¯”ç‰¹å¸åœ°å€ç±»å‹ï¼Œä¸»è¦æ˜¯ç”Ÿæˆ 4 ç§æ¯”ç‰¹å¸åœ°å€ï¼š
   - **P2PKH (Legacy)**ï¼šBase58 ç¼–ç ï¼Œ1 å¼€å¤´
   - **P2SH (å…¼å®¹ SegWit)**ï¼šBase58 ç¼–ç ï¼Œ3 å¼€å¤´
   - **P2WPKH (åŸç”Ÿ SegWit)**ï¼šBech32 ç¼–ç ï¼Œbc1q å¼€å¤´
   - **P2TR (Taproot)**ï¼šBech32m ç¼–ç ï¼Œbc1p å¼€å¤´

ğŸ“Œ åœ°å€çš„å­—èŠ‚æ•°ï¼š
| **åœ°å€ç±»å‹** | **ç¼–ç æ ¼å¼** | **åŸå§‹æ•°æ®å¤§å°** | **æœ€ç»ˆåœ°å€é•¿åº¦** | **å‰ç¼€** |
|-------------|-------------|----------------|----------------|--------|
| **P2PKH** | Base58Check | 25 å­—èŠ‚ | 34 å­—ç¬¦å·¦å³ | `1...` |
| **P2SH** | Base58Check | 25 å­—èŠ‚ | 34 å­—ç¬¦å·¦å³ | `3...` |
| **P2WPKH** | Bech32 | 21 å­—èŠ‚ | 42~46 å­—ç¬¦ | `bc1q...` |
| **P2TR** | Bech32m | 33 å­—èŠ‚ | 58~62 å­—ç¬¦ | `bc1p...` |


å…¬é’¥æ•°æ®æ ¼å¼æ¯”è¾ƒ:
1. å­—èŠ‚å¯¹è±¡è¡¨ç¤º: åŸå§‹äºŒè¿›åˆ¶æ•°æ®åœ¨Pythonä¸­çš„æ˜¾ç¤ºæ–¹å¼ï¼Œå°†ä¸€äº›å­—èŠ‚æ˜¾ç¤ºä¸ºè½¬ä¹‰åºåˆ—(\x)
2. åå…­è¿›åˆ¶è¡¨ç¤º: æ¯ä¸ªå­—èŠ‚è½¬æ¢ä¸ºä¸¤ä½åå…­è¿›åˆ¶æ•°ï¼Œè¿æ¥æˆå­—ç¬¦ä¸²ï¼Œç»Ÿä¸€ä¸”æ˜“è¯»

å‹ç¼©ä¸æœªå‹ç¼©å…¬é’¥:
- å‹ç¼©å…¬é’¥åªå­˜å‚¨Xåæ ‡å’ŒYåæ ‡çš„å¥‡å¶æ€§(é€šè¿‡å‰ç¼€03æˆ–02è¡¨ç¤º)
- æœªå‹ç¼©å…¬é’¥å­˜å‚¨å®Œæ•´çš„Xå’ŒYåæ ‡
- ä¸¤ç§æ ¼å¼å¯ä»¥äº’ç›¸è½¬æ¢ï¼Œå› ä¸ºæ¤­åœ†æ›²çº¿æ–¹ç¨‹å¯ä»¥ä»Xåæ ‡è®¡ç®—å‡ºYåæ ‡(æœ‰ä¸¤ä¸ªè§£ï¼Œé€šè¿‡å‰ç¼€åŒºåˆ†)
- å‹ç¼©æ ¼å¼ç”Ÿæˆçš„åœ°å€ä¸æœªå‹ç¼©æ ¼å¼ç”Ÿæˆçš„åœ°å€ä¸åŒ
   
äº¤æ˜“æµç¨‹:
ä½¿ç”¨ç§é’¥ç­¾åäº¤æ˜“ï¼Œé€šè¿‡å…¬é’¥éªŒè¯ç­¾åæœ‰æ•ˆæ€§ï¼Œå‘ç›®æ ‡åœ°å€è½¬è´¦ã€‚
æ•´ä¸ªè¿‡ç¨‹æ˜¯: ç§é’¥ç”Ÿæˆå…¬é’¥ï¼Œå…¬é’¥ç”Ÿæˆåœ°å€ï¼Œç§é’¥ç”¨äºç­¾åäº¤æ˜“ï¼Œå…¬é’¥ç”¨äºéªŒè¯ç­¾åã€‚

æœ¬ç¨‹åºç”Ÿæˆçš„æ˜¯æµ‹è¯•ç½‘P2PKHåœ°å€ï¼Œå¯ä»¥åœ¨æµ‹è¯•ç½‘åŒºå—æµè§ˆå™¨æŸ¥çœ‹:
https://live.blockcypher.com/btc-testnet/address/mhEMAY2yKRCWfM3ppcRrJe2pkZSzuVGQ7k/
'''
import hashlib
import base58
import ecdsa
import binascii
import random

class BitcoinTestNetWallet:
    def __init__(self):
        # æµ‹è¯•ç½‘ç‰ˆæœ¬å‰ç¼€
        self.TESTNET_PRIVATE_KEY_PREFIX = b'\xef'  # æµ‹è¯•ç½‘ç§é’¥å‰ç¼€
        self.TESTNET_ADDRESS_PREFIX = b'\x6f'      # æµ‹è¯•ç½‘åœ°å€å‰ç¼€
    
    def generate_private_key(self):
        """ç”Ÿæˆä¸€ä¸ªéšæœºçš„ç§é’¥"""
        # ç”Ÿæˆ32å­—èŠ‚ï¼ˆ256ä½ï¼‰çš„éšæœºæ•°ä½œä¸ºç§é’¥
        private_key_bytes = bytes([random.randint(0, 255) for _ in range(32)])
        return private_key_bytes
    
    def private_key_to_wif(self, private_key_bytes):
        """å°†ç§é’¥è½¬æ¢ä¸ºWIFæ ¼å¼"""
        # æ·»åŠ å‰ç¼€
        extended_key = self.TESTNET_PRIVATE_KEY_PREFIX + private_key_bytes
        
        # è®¡ç®—æ ¡éªŒå’Œ
        first_sha = hashlib.sha256(extended_key).digest()
        second_sha = hashlib.sha256(first_sha).digest()
        checksum = second_sha[:4]
        
        # æ‹¼æ¥å¹¶ç¼–ç 
        wif_key_bytes = extended_key + checksum
        wif_key = base58.b58encode(wif_key_bytes).decode('utf-8')
        
        return wif_key
    
    def get_public_key(self, private_key_bytes):
        """ä»ç§é’¥ç”Ÿæˆå…¬é’¥"""
        # ä½¿ç”¨SECP256k1æ›²çº¿
        sk = ecdsa.SigningKey.from_string(private_key_bytes, curve=ecdsa.SECP256k1)
        vk = sk.get_verifying_key()
        
        # è·å–å…¬é’¥å¹¶æ·»åŠ å‰ç¼€0x04
        public_key = b'\x04' + vk.to_string()
        
        # å‹ç¼©å…¬é’¥ç‰ˆæœ¬
        x_coord = vk.to_string()[:32]
        y_coord = vk.to_string()[32:]
        if int.from_bytes(y_coord, byteorder='big') % 2 == 0:
            compressed_public_key = b'\x02' + x_coord
        else:
            compressed_public_key = b'\x03' + x_coord
        
        return {
            'uncompressed': public_key.hex(),
            'compressed': compressed_public_key.hex()
        }
    
    def public_key_to_address(self, public_key_hex):
        """ä»å…¬é’¥ç”Ÿæˆæ¯”ç‰¹å¸åœ°å€"""
        # å°†å…¬é’¥è½¬æ¢ä¸ºå­—èŠ‚
        public_key_bytes = bytes.fromhex(public_key_hex)
        
        # è®¡ç®—SHA-256å“ˆå¸Œ
        sha256_hash = hashlib.sha256(public_key_bytes).digest()
        
        # è®¡ç®—RIPEMD-160å“ˆå¸Œ
        ripemd160 = hashlib.new('ripemd160')
        ripemd160.update(sha256_hash)
        ripemd160_hash = ripemd160.digest()
        
        # æ·»åŠ æµ‹è¯•ç½‘å‰ç¼€
        prefixed_ripemd160_hash = self.TESTNET_ADDRESS_PREFIX + ripemd160_hash
        
        # è®¡ç®—æ ¡éªŒå’Œ
        first_sha = hashlib.sha256(prefixed_ripemd160_hash).digest()
        second_sha = hashlib.sha256(first_sha).digest()
        checksum = second_sha[:4]
        
        # æ‹¼æ¥å¹¶ç¼–ç 
        address_bytes = prefixed_ripemd160_hash + checksum
        address = base58.b58encode(address_bytes).decode('utf-8')
        
        return address
    
    def generate_wallet(self):
        """ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„é’±åŒ…ï¼ŒåŒ…æ‹¬ç§é’¥ã€å…¬é’¥ã€åœ°å€å’ŒWIF"""
        # ç”Ÿæˆç§é’¥
        private_key_bytes = self.generate_private_key()
        private_key_hex = private_key_bytes.hex()
        
        # è½¬æ¢ä¸ºWIFæ ¼å¼
        wif = self.private_key_to_wif(private_key_bytes)
        
        # è·å–å…¬é’¥
        public_keys = self.get_public_key(private_key_bytes)
        
        # ä»å‹ç¼©å…¬é’¥ç”Ÿæˆåœ°å€
        address = self.public_key_to_address(public_keys['compressed'])
        
        return {
            'private_key': private_key_hex,
            'wif': wif,
            'public_key': public_keys,
            'address': address
        }

if __name__ == "__main__":
    wallet = BitcoinTestNetWallet()
    wallet_data = wallet.generate_wallet()
    
    print("\n===== æ¯”ç‰¹å¸æµ‹è¯•ç½‘é’±åŒ…,ä½¿ç”¨è‡ªå·±æ‰‹æ“æ‹¼æ¥ =====")
    print(f"åœ°å€: {wallet_data['address']}")
    print()
    print(f"ç§é’¥(HEX): {wallet_data['private_key']}")
    print(f"ç§é’¥(WIF): {wallet_data['wif']}")
    print(f"å…¬é’¥(æœªå‹ç¼©): {wallet_data['public_key']['uncompressed']}")
    print(f"å…¬é’¥(å‹ç¼©): {wallet_data['public_key']['compressed']}")
    print("\né‡è¦æç¤ºï¼š")
    print("1. è¯·ä¿å­˜å¥½ç§é’¥å’ŒWIFï¼Œè¿™æ˜¯è®¿é—®é’±åŒ…çš„å”¯ä¸€æ–¹å¼")
    print("2. è¿™æ˜¯æµ‹è¯•ç½‘åœ°å€ï¼Œåªèƒ½åœ¨æµ‹è¯•ç½‘ç»œä½¿ç”¨")
    print(f"3. å¯ä»¥åœ¨æµ‹è¯•ç½‘æµè§ˆå™¨æŸ¥çœ‹è¯¥åœ°å€ï¼šhttps://mempool.space/testnet/address/{wallet_data['address']}/")
